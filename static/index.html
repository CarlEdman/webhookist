<!DOCTYPE html>
<html>

<head>
  <title>Chat</title>
  <link href="/static/styles.css" rel="stylesheet">
</head>

<body>
  <h1>WebSocket Chat</h1>
  <form action="" onsubmit="sendMessage(event)">
    <input type="text" id="messageText" autocomplete="off" disabled />
    <button id="sendButton" disabled>Send</button>
  </form>
  <ul id='messages'>
  </ul>
  <script>
    var ws = new WebSocket("ws://" + document.location.host + "/ws");
    var button = document.getElementById('sendButton');
    var input = document.getElementById("messageText")
    ws.onmessage = function (event) {
      var messages = document.getElementById('messages')
      var message = document.createElement('li')
      var content = document.createTextNode(event.data)
      message.appendChild(content)
      messages.appendChild(message)
    };
    ws.onopen = function (event) {
      button.disabled = false
      input.disabled = false
    }
    ws.onclose = function (event) {
      button.disabled = true
      input.disabled = true
    }
    function sendMessage(event) {
      ws.send(input.value)
      input.value = ''
      event.preventDefault()
    }
  </script>
</body>

</html>
